<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Flang - Payment Receipt</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&family=Cairo:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Poppins', sans-serif;
            background-color: #f9fafb; /* Light gray background for contrast */
            color: #111827; /* Dark text */
            padding: 2rem;
        }
        .invoice-box {
            max-width: 800px;
            margin: auto;
            padding: 30px;
            border: 1px solid #eee;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.15);
            background-color: #fff;
        }
        .invoice-header {
            text-align: center;
            margin-bottom: 30px;
        }
        .invoice-header h1 {
            font-size: 2.5rem;
            font-weight: 700;
            color: #2596be; /* Ocean Blue */
            margin-bottom: 5px;
        }
         .invoice-details table {
            width: 100%;
            line-height: inherit;
            text-align: left;
        }
        .invoice-details table td {
            padding: 5px;
            vertical-align: top;
        }
        .invoice-details table tr td:nth-child(2) {
            text-align: right;
        }
        .invoice-body table {
            width: 100%;
            line-height: inherit;
            text-align: left;
            border-collapse: collapse;
            margin-top: 30px;
        }
        .invoice-body table th {
            background: #eee;
            border-bottom: 1px solid #ddd;
            font-weight: bold;
            padding: 10px;
        }
        .invoice-body table td {
            padding: 10px;
            border-bottom: 1px solid #eee;
        }
        .invoice-body table tr.total td {
            border-top: 2px solid #eee;
            font-weight: bold;
        }
        .rtl { direction: rtl; font-family: 'Cairo', sans-serif; }
        .rtl .invoice-details table td, .rtl .invoice-body table { text-align: right; }
        .rtl .invoice-details table tr td:nth-child(2) { text-align: left; }
        .rtl .invoice-body table th { text-align: right;}

        @media print {
            body { -webkit-print-color-adjust: exact; padding: 0; margin: 0; }
            .invoice-box { box-shadow: none; border: none; margin: 0; padding: 0; }
            button { display: none; }
        }

    </style>
</head>
<body class="ltr">

    <div class="invoice-box">
        <div class="invoice-header">
            <h1>Flang</h1>
            <p class="lang-en">Payment Receipt</p>
            <p class="lang-ar hidden">إيصال الدفع</p>
        </div>

        <div class="invoice-details">
            <table>
                <tr>
                    <td>
                        <strong class="lang-en">Receipt Date:</strong><strong class="lang-ar hidden">تاريخ الإيصال:</strong> <span id="receiptDate"></span><br>
                        <strong class="lang-en">Billed To:</strong><strong class="lang-ar hidden">إلى:</strong> <span id="receiptName"></span>
                    </td>
                    <td>
                        Sudstudy LLC.<br>
                        Cairo, Egypt<br>
                        info@sudstudy.com
                    </td>
                </tr>
            </table>
        </div>

        <div class="invoice-body">
            <table>
                <thead>
                    <tr>
                        <th class="lang-en">Item</th><th class="lang-ar hidden">البند</th>
                        <th class="text-right lang-en">Price (EGP)</th><th class="text-left lang-ar hidden">السعر (ج.م)</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>
                            <span class="lang-en">Flang Program Access:</span><span class="lang-ar hidden">الوصول لبرنامج فلانج:</span>
                            <span id="receiptPlan" class="capitalize"></span>
                        </td>
                        <td id="receiptOriginalAmount" class="text-right"></td>
                    </tr>
                    <tr id="discountRow" class="hidden">
                        <td>
                            <span class="lang-en">Discount Applied (<span id="receiptDiscountPercent"></span>%):</span>
                            <span class="lang-ar hidden">الخصم المطبق (<span id="receiptDiscountPercentAr"></span>%):</span>
                        </td>
                        <td id="receiptDiscountAmount" class="text-right"></td>
                    </tr>
                    <tr class="total">
                        <td></td>
                        <td class="text-right">
                            <strong class="lang-en">Total Due:</strong><strong class="lang-ar hidden">الإجمالي المستحق:</strong>
                            <span id="receiptTotalAmount"></span> EGP / ج.م
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>

        <div class="text-center mt-8 text-gray-600 text-sm">
             <p class="lang-en">Thank you for joining Flang! Please follow payment instructions sent via WhatsApp.</p>
             <p class="lang-ar hidden">شكراً لانضمامك إلى فلانج! يرجى اتباع تعليمات الدفع المرسلة عبر واتساب.</p>
             <button onclick="window.print()" class="mt-4 bg-gray-300 text-gray-800 font-semibold py-2 px-4 rounded hover:bg-gray-400">
                <span class="lang-en">Print Receipt</span><span class="lang-ar hidden">طباعة الإيصال</span>
             </button>
        </div>
    </div>

    <script>
        function switchReceiptLanguage(lang) {
            const body = document.body;
            const enElements = document.querySelectorAll('.lang-en');
            const arElements = document.querySelectorAll('.lang-ar');

            if (lang === 'ar') {
                body.classList.remove('ltr');
                body.classList.add('rtl');
                enElements.forEach(el => el.classList.add('hidden'));
                arElements.forEach(el => el.classList.remove('hidden'));
            } else { // Default to English
                body.classList.remove('rtl');
                body.classList.add('ltr');
                arElements.forEach(el => el.classList.add('hidden'));
                enElements.forEach(el => el.classList.remove('hidden'));
            }
        }

        document.addEventListener('DOMContentLoaded', () => {
            const urlParams = new URLSearchParams(window.location.search);
            const name = urlParams.get('name') || 'Valued Member';
            const plan = urlParams.get('plan') || 'N/A';
            const amount = parseFloat(urlParams.get('amount') || '0');
            const originalAmount = parseFloat(urlParams.get('originalAmount') || amount); // Default to final amount if original not provided
            const discountPercent = parseInt(urlParams.get('discount') || '0');
            const date = urlParams.get('date') || new Date().toLocaleDateString('en-GB');

            document.getElementById('receiptDate').textContent = date;
            document.getElementById('receiptName').textContent = name;
            document.getElementById('receiptPlan').textContent = plan.charAt(0).toUpperCase() + plan.slice(1);
            document.getElementById('receiptOriginalAmount').textContent = originalAmount.toFixed(2);
            document.getElementById('receiptTotalAmount').textContent = amount.toFixed(2);

            if (discountPercent > 0) {
                const discountAmount = originalAmount - amount;
                document.getElementById('receiptDiscountPercent').textContent = discountPercent;
                document.getElementById('receiptDiscountPercentAr').textContent = discountPercent; // Assuming same number format
                document.getElementById('receiptDiscountAmount').textContent = `- ${discountAmount.toFixed(2)}`;
                document.getElementById('discountRow').classList.remove('hidden');
            }

            // Simple language check based on browser or stored pref (optional)
            const storedLang = localStorage.getItem('flangLanguage') || (navigator.language.startsWith('ar') ? 'ar' : 'en');
             switchReceiptLanguage(storedLang);

        });
    </script>

</body>
</html>
