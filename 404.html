<script>
        // 1. LANGUAGE LOGIC
        let currentLang = 'en';
        function toggleLang() {
            currentLang = currentLang === 'en' ? 'ar' : 'en';
            const html = document.documentElement;
            html.setAttribute('dir', currentLang === 'ar' ? 'rtl' : 'ltr');
            
            document.querySelectorAll('.lang-en').forEach(el => el.style.display = currentLang === 'en' ? 'block' : 'none');
            document.querySelectorAll('.lang-ar').forEach(el => el.style.display = currentLang === 'ar' ? 'block' : 'none');
        }

        // 2. SCROLL HEADER
        window.addEventListener('scroll', () => {
            const header = document.querySelector('.header');
            if (window.scrollY > 50) header.classList.add('is-scrolled');
            else header.classList.remove('is-scrolled');
        });

        // 3. UNIVERSAL SMOOTH SCROLL (No '#' in URL for Footer or Nav)
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault(); // Stop the hash from entering URL
                const targetId = this.getAttribute('href');
                if (targetId === '#') return; // Ignore empty links
                
                const targetElement = document.querySelector(targetId);
                if (targetElement) {
                    // Offset for fixed header
                    const headerOffset = 80;
                    const elementPosition = targetElement.getBoundingClientRect().top;
                    const offsetPosition = elementPosition + window.pageYOffset - headerOffset;

                    window.scrollTo({
                        top: offsetPosition,
                        behavior: "smooth"
                    });
                }
            });
        });

        // 4. ANIMATED COUNTERS
        const observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    const el = entry.target;
                    const target = +el.getAttribute('data-target');
                    const duration = 2000; 
                    const step = Math.ceil(target / (duration / 16));
                    let current = 0;
                    
                    const timer = setInterval(() => {
                        current += step;
                        if(current >= target) {
                            el.textContent = target.toLocaleString() + (target > 1000 ? '+' : '%');
                            if(target === 95) el.textContent = "95%"; 
                            clearInterval(timer);
                        } else {
                            el.textContent = current.toLocaleString();
                        }
                    }, 16);
                    observer.unobserve(el);
                }
            });
        }, { threshold: 0.5 });

        document.querySelectorAll('.metric-value').forEach(el => observer.observe(el));
    </script>
